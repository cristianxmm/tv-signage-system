<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Control TV</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
        .card { background: white; padding: 20px; border-radius: 8px; max-width: 500px; margin: 0 auto; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        input, select, button { width: 100%; margin-bottom: 15px; padding: 10px; }
        button { background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="card">
        <h2>ðŸ“¡ Control de Pantallas</h2>
        
        <label>Selecciona Pantalla:</label>
        <select id="target">
            <option value="all">Todas las Pantallas</option>
            <option value="recepcion">RecepciÃ³n</option>
            <option value="logistica">LogÃ­stica</option>
        </select>

        <label>Subir Archivo(s):</label>
        <input type="file" id="archivo" multiple>

        <button onclick="enviar()">Publicar Contenido</button>
        <p id="status"></p>
    </div>

    <script>
        async function enviar() {
            const input = document.getElementById('archivo');
            const target = document.getElementById('target').value;
            const status = document.getElementById('status');

            if (input.files.length === 0) return alert("Selecciona algo primero");

            const formData = new FormData();
            formData.append('target', target);
            
            // Agregamos todos los archivos seleccionados
            for (let i = 0; i < input.files.length; i++) {
                formData.append('archivos', input.files[i]);
            }

            status.innerText = "â³ Enviando...";

            try {
                const res = await fetch('/publicar', {
                    method: 'POST',
                    body: formData,
                    // AGREGAMOS ESTO para la autenticaciÃ³n bÃ¡sica
                    headers: {
                        'Authorization': 'Basic ' + btoa('admin:123') // âš ï¸ Usa tu usuario:pass real
                    }
                });
                
                if (res.ok) status.innerText = "âœ… Â¡Enviado con Ã©xito!";
                else status.innerText = "âŒ Error al enviar.";
            } catch (e) {
                console.error(e);
                status.innerText = "âŒ Error de conexiÃ³n.";
            }
        }
    </script>
</body>
</html>